{
  "hash": "446d58afb3d5255fcbadfa6f6b97f3b6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Temperetura atmosf√©rica na Regi√£o Integrada de Desenvolvimento do Distrito Federal e Entorno\nsubtitle: Estava quente na RIDE no dia do meu aniver√°rio no primeiro ano da pandemia? \nauthor:\n  - name: Carolina Musso\n    orcid: 0000-0002-8107-6458\n    corresponding: true\n    email: cmusso86@gmail.com\n    roles:\n      - Mestranda PPGEST\n    affiliations:\n      - Universidade de Bras√≠lia\nabstract: |\n  Em 22 de outubro de 2020, data pessoalmente significativa para a autora, foram extra√≠dos dados de temperatura da superf√≠cie terrestre (LST) para a Regi√£o Integrada de Desenvolvimento do Distrito Federal e Entorno (RIDE-DF), com base em imagens do sat√©lite MODIS. Os dados foram filtrados para incluir apenas os munic√≠pios pertencentes √† RIDE. Em seguida, avaliou-se o ajuste de diferentes modelos de variogramas aos dados, optando-se por um modelo Exponencial.  Ent√£o, aplicou-se a krigagem ordin√°ria para interpolar uma superf√≠cie cont√≠nua de temperatura e comparou-se com a krigagem universal, que foram considerados equivalentes. A superf√≠cie resultante oferece uma vis√£o da estrutura espacial da varia√ß√£o de temperatura na regi√£o durante um dia especialmente quente (para mim) e memor√°vel de 2020. e n√£o apenas uma mera curiosidade geogr√°fica, mas tamb√©m um exerc√≠cio de aplica√ß√£o de t√©cnicas geoestat√≠sticas em um contexto pessoal e afetivo.\n\nplain-language-summary: |\n  Utilizando dados de sat√©lite do dia 22 de outubro de 2020, este estudo estimou uma superf√≠cie cont√≠nua de temperatura para a regi√£o da RIDE-DF, no Brasil. T√©cnicas de interpola√ß√£o espacial (krigagem) foram aplicadas para mapear como a temperatura variava ao longo do territ√≥rio em um dia quente de primavera, no primeiro ano da pandemia de COVID-19.\n\nkey-points:\n  - Dados de temperatura de superf√≠cie provenientes do sat√©lite MODIS foram processados para a regi√£o da RIDE-DF em 22/10/2020\n  - Diversos modelos de variograma foram testados; o modelo exponencial apresentou o melhor ajuste para a krigagem\n  - A superf√≠cie interpolada ilustra a varia√ß√£o espacial da temperatura durante um dia de primavera marcante na regi√£o da RIDE\n  \nkeywords:\n  - Krigging\n  - Temperatura\n  - RIDE\nlang: pt\nexecute:\n  echo: false\n  warning: false\n  message: false\nnotebook-links: false\ndate: last-modified\nbibliography: references.bib\ncitation:\n  container-title: Earth and Space Science\nnumber-sections: true\n---\n\n\n\n\n## Introdu√ß√£o\n\nH√° quem n√£o goste de comemorar anivers√°rios. N√£o √© o meu caso. Gosto tanto que, quando um anivers√°rio termina, j√° come√ßo a planejar o do ano seguinte. Por isso, lembro com nitidez do ano em que a comemora√ß√£o n√£o aconteceu: 2020, o primeiro ano da pandemia de COVID-19. Claro, entre as muitas consequ√™ncias daquele ano dif√≠cil, a aus√™ncia de uma festa de anivers√°rio pessoal est√° longe de ser a mais relevante, mas n√£o deixa de ser memor√°vel, ao menos para mim.\n\nAl√©m da aus√™ncia de bolo e parab√©ns, 2020 foi, curiosamente, um dos anos em que mais trabalhei. Estive envolvida com a Secretaria de Sa√∫de, com o Minist√©rio da Sa√∫de e com a Faculdade de Ci√™ncias da Sa√∫de da UnB. Em meio a plant√µes, pesquisas, boletins epidemiol√≥gicos e videochamadas sem fim, conheci algo que nunca tinha ouvido falar antes: a RIDE.\n\nA RIDE (Regi√£o Integrada de Desenvolvimento do Distrito Federal e Entorno,  @fig-mapa-ride) √© uma unidade regional composta pelo Distrito Federal e diversos munic√≠pios lim√≠trofes dos estados de Goi√°s e Minas Gerais. Seu objetivo √© promover o planejamento e a execu√ß√£o integrada de pol√≠ticas p√∫blicas, especialmente em √°reas como transporte, sa√∫de, educa√ß√£o e infraestrutura, de modo a articular o desenvolvimento socioecon√¥mico da capital federal com o de seu entorno imediato. O DF, por sua posi√ß√£o central e por concentrar muitos servi√ßos p√∫blicos, presta servi√ßos √† regi√£o em m√∫ltiplas frentes, como sa√∫de, empregos e educa√ß√£o.\n\nA aus√™ncia de uma festa e o calor escaldante de um apartamento sem ar-condicionado, com as janelas vedadas por conta de uma reforma de fachada, deixaram uma impress√£o permanente na mem√≥ria. Assim, RIDE, anivers√°rio e temperatura se entrela√ßam para compor este trabalho.\n\nO objetivo deste relat√≥rio √© aplicar t√©cnicas de geoestat√≠stica, em especial a krigagem, para estimar a superf√≠cie de temperatura do dia 22 de outubro de 2020, data do meu anivers√°rio, em toda a extens√£o da RIDE. A krigagem √© um m√©todo de interpola√ß√£o espacial que utiliza modelos variogr√°ficos para estimar valores em locais n√£o amostrados, levando em considera√ß√£o a autocorrela√ß√£o espacial dos dados. Trata-se, portanto, de uma ferramenta poderosa para reconstruir superf√≠cies cont√≠nuas a partir de dados pontuais, como √© o caso das observa√ß√µes de temperatura registradas por sensores ou sat√©lites.\n\nMais do que um pretexto pessoal, este trabalho busca ilustrar o potencial da geoestat√≠stica na compreens√£o de padr√µes espaciais de vari√°veis ambientais, mesmo (ou especialmente) em datas de valor afetivo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nrm(list=ls())\nif(!require(\"pacman\")) install.packages(\"pacman\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: pacman\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npacman::p_load(\n  patchwork,\n  tidyverse, \n  sf, \n  rio,\n  rnaturalearth, \n  rnaturalearthdata, \n  sp, \n  gstat, \n  mapview,\n  ggspatial,\n  modisfast,\n  ggrepel,\n  automap,\n  stars\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## ler os shapefiles com pacote sp\nride_sf <- sf::read_sf(\"RIDE/.\")\nride_sf_centroids <- st_centroid(ride_sf)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncoords <- st_coordinates(ride_sf_centroids)\nride_sf_labels <- cbind(ride_sf, coords)\nride_sf_labels$NM_MUNICIP <- str_wrap(ride_sf_labels$NM_MUNIC, width = 12)\ng1<-ride_sf |> ggplot()+\n  geom_sf() +\n  scale_fill_viridis_c() +\n  geom_text_repel(\n    data = ride_sf_labels,\n    aes(x = X, y = Y, label = NM_MUNICIP),\n    size = 2.5,\n    color = \"black\",\n  point.padding = 0.1,     # Reduz a dist√¢ncia do texto ao ponto central\n  force = 1# Remove as linhas se quiser deixar s√≥ o tilt\n  ) +\n  theme_minimal(base_size=14) +\n  labs(\n    title = \"RIDE\",\n    caption = \"Fonte: IPEDF\"\n  ) +\n\n  theme(legend.position = \"bottom\") +\n  annotation_scale(location = \"br\", width_hint = 0.5) \nggsave(\"ride.png\", g1, width = 8, height = 6, dpi = 300)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: ggrepel: 1 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n:::\n\n::: {#cell-fig-mapa-ride .cell}\n\n```{.r .cell-code .hidden}\nknitr::include_graphics(\"ride.png\")\n```\n\n::: {.cell-output-display}\n![Munic√≠pios que comp√µem a RIDE (Regi√£o Integrada de Desenvolvimento do DF e Entorno).](ride.png){#fig-mapa-ride}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# username <- \"\"\n# password <- \"\"\n# mf_login(credentials = c(username, password))\n# \n# \n# roi <- st_as_sf(\n#   data.frame(id = \"ride_df\",\n#              geom =  \"POLYGON ((-49.36 -17.36, -49.36 -13.10, -45.56 -13.10, -45.56 -17.36, -49.36 -17.36))\"),\n#   wkt = \"geom\", crs = 4326\n# )\n# \n# \n# collection <- \"MOD11A1.061\" #10:30\n# variables <- c(\"LST_Day_1km\")\n# time_range <- as.Date(c(\"2020-10-22\", \"2020-10-22\"))\n# \n# urls <- mf_get_url(collection = collection, variables = variables,\n#                    roi = roi, time_range = time_range)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# res <-  mf_download_data(urls)\n# \n# \n# rast <- mf_import_data(\n#   path = unique(dirname(res$destfile))[1],\n#   collection = collection,\n#   proj_epsg = 4326)\n# \n# df <- as.data.frame(rast, xy = TRUE)\n# df$lst_c <- df$LST_Day_1km - 273.15\n# \n# # 7) Exportar como CSV\n# write.csv(df[, c(\"x\",\"y\",\"lst_c\")], \"temperatura_geral.csv\", row.names = FALSE)\n# \n```\n:::\n\n\n\n\n\n\n## Material e M√©todos {#sec-data-methods}\n\nPara a obten√ß√£o dos dados de temperatura utilizados neste trabalho, recorreu-se √† plataforma Earthdata, mantida pela NASA em parceria com o Servi√ßo Geol√≥gico dos Estados Uniddos (USGS), que disponibiliza produtos de sensoriamento remoto derivados do sensor MODIS (Moderate Resolution Imaging Spectroradiometer), a bordo dos sat√©lites Terra e Aqua [@wan2002modis; @earthdata].\n\nFoi utilizada uma cole√ß√£o di√°ria de temperatura da superf√≠cie terrestre (Land Surface Temperature ‚Äì LST), registrada no per√≠odo diurno, aproximadamente √†s 10h30 no hor√°rio local, com resolu√ß√£o espacial de 1 km¬≤. Essa vari√°vel representa a temperatura radiativa da superf√≠cie da Terra, estimada a partir da emiss√£o t√©rmica captada pelos sensores MODIS. Os dados s√£o originalmente fornecidos em kelvin e foram convertidos para graus Celsius para facilitar a an√°lise e a interpreta√ß√£o. A data selecionada foi 22 de outubro de 2020, coincidindo com o anivers√°rio da autora e escolhida como eixo tem√°tico do estudo.\n\nA √°rea de interesse corresponde √† Regi√£o Integrada de Desenvolvimento do Distrito Federal e Entorno (RIDE-DF), composta pelo Distrito Federal por 34 munic√≠pios de seu entorno, sendo 30 localizados no estado de Goi√°s e 4 em Minas Gerais, conforme estabelecido pela legisla√ß√£o federal vigente. Para delimitar essa regi√£o, foi utilizado um pol√≠gono geogr√°fico de refer√™ncia com abrang√™ncia compat√≠vel com os limites da RIDE. Os dados de temperatura foram ent√£o recortados com base nesse pol√≠gono, de forma a manter apenas os pontos efetivamente situados dentro da √°rea de estudo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndf <- read_csv(\"temperatura_geral.csv\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 110038 Columns: 3\n‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nDelimiter: \",\"\ndbl (3): x, y, lst_c\n\n‚Ñπ Use `spec()` to retrieve the full column specification for this data.\n‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndados_latlong_sf <- st_as_sf(df, coords = c(\"x\", \"y\"), crs = 4326)\n\n# 2. Reprojetar para o mesmo CRS do munic√≠pio\ndados_latlong_sf_proj <- st_transform(dados_latlong_sf, crs = st_crs(ride_sf))\n\n# 3. Filtrar apenas os pontos *dentro* do munic√≠pio\ndados_ride_latlong <- st_filter(dados_latlong_sf_proj, ride_sf)  # ‚úÖ correto!\ndados_ride_latlong <- dados_ride_latlong[seq(1, nrow(dados_ride_latlong), by = 18), ] #15 x18 16 \n\n# 6. Criar banco com latitude/longitude (graus decimais)\ndados_latlong <- dados_ride_latlong %>%\n  mutate(\n    x = st_coordinates(geometry)[,1],\n    y = st_coordinates(geometry)[,2]\n  ) %>%\n  select(lst_c, x, y) %>%\n  as.data.frame() %>%\n  select(-geometry) %>% \n  rename(avg_z=lst_c)\n\n# 7. Transformar para UTM (zona 23S - SIRGAS 2000 / EPSG:31983)\ndados_utm_sf <- st_transform(dados_ride_latlong, crs = 31983)\n\n# 8. Criar banco com coordenadas UTM (em metros)\ndados_utm <- dados_utm_sf %>%\n  mutate(\n    x = st_coordinates(geometry)[,1],\n    y = st_coordinates(geometry)[,2]\n  ) %>%\n  select(lst_c, x, y) %>%\n  as.data.frame() %>%\n  select(-geometry)%>% \n  rename(avg_z=lst_c)\n\n\n\n# 9. Exportar os dois arquivos\nwrite.csv(dados_latlong, \"RIDE_temp_latlong.csv\", row.names = FALSE)\nwrite.csv(dados_utm,     \"RIDE_temp_utm.csv\",     row.names = FALSE)\n\n#set.seed(181326) \n#set.seed(181019)# para reprodutibilidade\nset.seed(020279)\n\ngrid <- st_make_grid(dados_utm_sf, n = c(20, 20), what = \"centers\")\n\n# Associa cada ponto ao centro de c√©lula mais pr√≥ximo\ndados_utm_sf$cell_id <- st_nearest_feature(dados_utm_sf, grid)\n\n# Pega o ponto mais pr√≥ximo do centro de cada c√©lula (1 por c√©lula)\ndados_utm_sf_amostra <- dados_utm_sf %>%\n  group_by(cell_id) %>%\n  slice_sample(n = 1) |> \n  rename(temp = lst_c) |>\n  select(-3)\n```\n:::\n\n\n\n\n\nNo total, foram utilizados 181 medi√ß√µes . As coordenadas dos pontos de temperatura foram obtidas tanto em formato geogr√°fico (latitude e longitude) quanto em sistema projetado UTM (Universal Transverse Mercator, zona 23S, SIRGAS 2000), sendo este √∫ltimo utilizado nas an√°lises geoestat√≠sticas por ser mais adequado ao c√°lculo de dist√¢ncias em metros. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ng2 <- ggplot() +\n  geom_sf(data = ride_sf, fill = NA, color = \"black\", linewidth = 0.1) +  # pol√≠gono em preto\n  geom_sf(data = dados_utm_sf_amostra, aes(color = temp), size = 2) +  # pontos coloridos\n  #acrescentar rotulos com nome dos municipios\n  \n  scale_color_viridis_c(name = \"Temperatura (¬∞C)\") +\n  theme_minimal(base_size=12) +\n  labs(\n    title = \"Pontos de medi√ß√£o\\n Temperatura na RIDE-DF\",\n    caption = \"Fonte: Earthdata, NASA\"\n  )\nggsave(\"ride_temp_points.png\", g2, width = 8, height = 6, dpi = 300)\n```\n:::\n\n::: {#cell-fig-pontos-amostrados .cell}\n\n```{.r .cell-code .hidden}\nknitr::include_graphics(\"ride_temp_points.png\")\n```\n\n::: {.cell-output-display}\n![Pontos amostrados de temperatura da superf√≠cie terrestre (¬∞C) na RIDE-DF.](ride_temp_points.png){#fig-pontos-amostrados}\n:::\n:::\n\n\n\n\nCom os dados preparados, procedeu-se √† aplica√ß√£o da krigagem ordin√°ria, t√©cnica de interpola√ß√£o espacial baseada na teoria dos processos estoc√°sticos estacion√°rios, que utiliza a estrutura de autocorrela√ß√£o espacial da vari√°vel observada para gerar estimativas em pontos n√£o amostrados.\n\n## Resultados\n\nA fim de estimar a temperatura da superf√≠cie terrestre em locais n√£o amostrados dentro da RIDE-DF, foi realizada a modelagem do variograma emp√≠rico com base na amostra dos 181 pontos. Para isso, foram testados diferentes modelos te√≥ricos de variograma, esf√©rico, gaussiano, exponencial e linear, com diferentes valores de sill, range e nugget  com o objetivo de avaliar qual estrutura de depend√™ncia espacial melhor se ajustava aos dados.\n\nA compara√ß√£o visual dos ajustes ( @fig-ajuste-variogramas) mostrou que os modelos esf√©rico  e exponencial foram capazes de capturar razoavelmente bem a tend√™ncia observada no variograma emp√≠rico. O modelo gaussiano n√£o se ajustou bem quando os dados atingiam o range e o modelo linear apresentou instabilidades no processo de ajuste, com alerta de singularidade, e foi descartado da an√°lise final.  O gr√°fico resultante mostra a semivari√¢ncia m√©dia dos pares de pontos em fun√ß√£o da dist√¢ncia que os separa, evidenciando o grau de depend√™ncia espacial da vari√°vel.\n\n\nO modelo exponencial foi selecionado para as an√°lises de krigagem, por apresentar o melhor compromisso entre ader√™ncia visual ao variograma emp√≠rico, simplicidade de interpreta√ß√£o e estabilidade num√©rica no ajuste. Conforme discutido por Moraga (2022), esse modelo √© especialmente √∫til quando a correla√ß√£o espacial decresce suavemente com a dist√¢ncia, o que foi observado nos dados analisados.\n\nCom o modelo exponencial ajustado, foi realizada a krigagem ordin√°ria sobre uma grade regular de pontos com espa√ßamento de 1 km dentro da √°rea da RIDE. O resultado foi a gera√ß√£o de uma superf√≠cie cont√≠nua de temperatura estimada, representando a varia√ß√£o espacial da LST em toda a regi√£o no dia 22 de outubro de 2020.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# 1. Calcula variograma\nv <- variogram(temp ~ 1, data = dados_utm_sf_amostra)\nv$dist <- v$dist / 1000  # converte para km\n\n# 2. Ajusta modelos\nfit_sph <- fit.variogram(v, model = vgm(psill = 15, model = \"Sph\", range = 200, nugget = 3))\nfit_gau <- fit.variogram(v, model = vgm(psill = 15, model = \"Gau\", range = 200, nugget = 3))\nfit_exp <- fit.variogram(v, model = vgm(psill = 10, model = \"Exp\", range = 200, nugget = 2))\nfit_lin <- fit.variogram(v, model = vgm(psill = 15, model = \"Lin\", range = 200, nugget = 3))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in fit.variogram(v, model = vgm(psill = 15, model = \"Lin\", range = 200,\n: singular model in variogram fit\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# 3. Cria gr√°ficos com ggplot2\ng1 <- ggplot() +\n  geom_point(data = v, aes(x = dist, y = gamma)) +\n  geom_line(data = variogramLine(fit_sph, maxdist = max(v$dist)), aes(x = dist, y = gamma), color = \"blue\") +\n  labs(title = \"Modelo Esf√©rico\", x = \"Dist√¢ncia (km)\", y = \"Semivari√¢ncia\") +\n  theme_minimal()\n\ng2 <- ggplot() +\n  geom_point(data = v, aes(x = dist, y = gamma)) +\n  geom_line(data = variogramLine(fit_gau, maxdist = max(v$dist)), aes(x = dist, y = gamma), color = \"green\") +\n  labs(title = \"Modelo Gaussiano\", x = \"Dist√¢ncia (km)\", y = \"Semivari√¢ncia\") +\n  theme_minimal()\n\ng3 <- ggplot() +\n  geom_point(data = v, aes(x = dist, y = gamma)) +\n  geom_line(data = variogramLine(fit_exp, maxdist = max(v$dist)), aes(x = dist, y = gamma), color = \"red\") +\n  labs(title = \"Modelo Exponencial\", x = \"Dist√¢ncia (km)\", y = \"Semivari√¢ncia\") +\n  theme_minimal()\n\ng4 <- ggplot() +\n  geom_point(data = v, aes(x = dist, y = gamma)) +\n  geom_line(data = variogramLine(fit_lin, maxdist = max(v$dist)), aes(x = dist, y = gamma), color = \"purple\") +\n  labs(title = \"Modelo Linear\", x = \"Dist√¢ncia (km)\", y = \"Semivari√¢ncia\") +\n  theme_minimal()\n```\n:::\n\n::: {#cell-fig-ajuste-variogramas .cell}\n\n```{.r .cell-code .hidden}\n# 4. Patchwork: 2x2\n(g1 | g2) / (g3 | g4)\n```\n\n::: {.cell-output-display}\n![Compara√ß√£o de modelos de variograma ajustados aos dados de temperatura da superf√≠cie terrestre na RIDE-DF.](index_files/figure-jats/fig-ajuste-variogramas-1.png){#fig-ajuste-variogramas}\n:::\n:::\n\n\n\n\nNa sequ√™ncia, foi ajustado um modelo te√≥rico exponencial, com par√¢metros iniciais definidos para o patamar (sill), efeito pepita (nugget) e alcance (range). O ajuste obteve converg√™ncia e mostrou boa ader√™ncia visual ao variograma emp√≠rico, respeitando a tend√™ncia de crescimento r√°pido da semivari√¢ncia para pequenas dist√¢ncias, caracter√≠stica compat√≠vel com esse tipo de modelo.\n\nO modelo ajustado estimou um nugget de aproximadamente 3, indicando uma parcela de variabilidade que n√£o √© explicada pela estrutura espacial, possivelmente atribu√≠da a erros de medi√ß√£o, microvaria√ß√µes locais ou ru√≠do do processo. O sill (patamar da vari√¢ncia total) foi estimado em torno de 15, valor que representa o n√≠vel de estabiliza√ß√£o da semivari√¢ncia para dist√¢ncias maiores. J√° o range foi estimado em cerca de 150 km, sugerindo que pontos distantes at√© essa ordem de magnitude ainda apresentam correla√ß√£o espacial significativa.\n\nEsses valores s√£o consistentes com um cen√°rio em que a temperatura de superf√≠cie apresenta autocorrela√ß√£o espacial de m√©dia escala, com varia√ß√£o gradual ao longo do territ√≥rio da RIDE, o que justifica o uso da krigagem como interpolador.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Criar grade regular mais esparsa (5 km em vez de 1 km)\nvc <- variogram(temp ~ 1, dados_utm_sf_amostra)\nvinitial <- vgm(psill = 15, model = \"Exp\", range = 150000, nugget = 3)\nfv <- fit.variogram(vc, model = vinitial)\nride_utm <- st_transform(ride_sf, 31983)\n\n# üî≥ Criar grade regular de pontos dentro da RIDE\ngrid <- st_make_grid(ride_utm, cellsize = 1000, what = \"centers\")\ngrid_sf <- st_sf(geometry = grid, crs = st_crs(ride_utm))\ngrid_sf <- grid_sf[ride_utm, ]\n\n# ü§ñ Krigagem\nk <- gstat(formula = temp ~ 1, data = dados_utm_sf_amostra, model = fv)\nkpred <- predict(k, newdata = grid_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[using ordinary kriging]\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nkpred_sf <- st_as_sf(kpred)\n\n# üåç Proje√ß√£o para latitude/longitude\nride_latlon <- st_transform(ride_utm, 4326)\n\nkpred_latlon <- st_transform(kpred_sf, 4326)\n```\n:::\n\n\n\n\nPara a aplica√ß√£o da krigagem, foi constru√≠da uma grade regular de predi√ß√£o sobre a √°rea da RIDE, com espa√ßamento de 2.500 metros entre os pontos centrais. Esse valor foi escolhido com o objetivo de manter boa resolu√ß√£o espacial ao mesmo tempo em que se preserva a legibilidade visual da trama da grade. Os pontos da grade foram filtrados para incluir apenas aqueles contidos dentro dos limites geogr√°ficos da regi√£o de estudo.\n\nA @fig-grade-krigagem apresenta os pontos da grade de predi√ß√£o (em vermelho) distribu√≠dos de forma homog√™nea ao longo da RIDE, al√©m dos pontos amostrados utilizados para o ajuste da krigagem. Estes pontos amostrados est√£o representados por marcadores pretos, acompanhados dos respectivos valores de temperatura da superf√≠cie terrestre (em graus Celsius).\n\n\n\n\n::: {#cell-fig-grade-krigagem .cell}\n\n```{.r .cell-code .hidden}\ndados_lab <- dados_utm_sf_amostra %>%\n  mutate(temp_label = sprintf(\"%.1f\", temp))\n# Gr√°fico\nggplot() +\n  geom_sf(data = ride_utm, fill = NA, color = \"black\") +  # contorno da RIDE\n  geom_sf(data = grid_sf, color = \"darkred\", size = 0.1, alpha = 0.6) +  # pontos do grid\n  geom_sf(data = dados_lab, size = 1.2, shape = 21, fill = \"black\") +  # pontos amostrados pretos\n  geom_sf_text(data = dados_lab, aes(label = temp_label), size = 2, nudge_y = 10000) +  # temperatura como texto\n  theme_minimal(base_size=12) +\n  labs(\n    title = \"Grid de krigagem \",\n    subtitle = \"Espa√ßamento de 5 km\",\n    caption = \"Fonte: Earthdata, NASA\"\n  )\n```\n\n::: {.cell-output-display}\n![Grid predi√ß√£o (2,5 km) e pontos\n com temperatura observada.](index_files/figure-jats/fig-grade-krigagem-1.png){#fig-grade-krigagem}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndados_utm_sf_amostra <- dados_utm_sf_amostra %>%\n  mutate(\n    x = st_coordinates(geometry)[,1],\n    y = st_coordinates(geometry)[,2]\n  )\ngrid_sf <- grid_sf %>%\n  mutate(\n    x = st_coordinates(geometry)[,1],\n    y = st_coordinates(geometry)[,2]\n  )\n# Krigagem com tend√™ncia espacial (universal)\nk_uni <- gstat(\n  formula = temp ~ x + y,\n  data = dados_utm_sf_amostra,\n  model = fv\n)\n\n# Predi√ß√£o sobre a grade\nkpred_uni <- predict(k_uni, newdata = grid_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[using universal kriging]\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nkpred_uni_sf <- st_as_sf(kpred_uni)\n```\n:::\n\n\n\n\nAl√©m da krigagem ordin√°ria, foi tamb√©m aplicada a krigagem universal, que considera a presen√ßa de uma tend√™ncia espacial global na m√©dia da vari√°vel de interesse. Nesse caso, admitiu-se que a temperatura da superf√≠cie terrestre poderia variar de forma sistem√°tica ao longo do espa√ßo, e essa tend√™ncia foi modelada por meio das pr√≥prias coordenadas UTM (x e y) dos pontos de amostragem.\n\nO modelo ajustado incorporou essa estrutura, permitindo estimar a m√©dia da temperatura como uma fun√ß√£o linear das coordenadas espaciais, enquanto a depend√™ncia residual foi tratada pela estrutura variogr√°fica previamente ajustada.\n\nApesar da incorpora√ß√£o dessa estrutura adicional no modelo, a compara√ß√£o visual entre os mapas resultantes da krigagem ordin√°ria e da krigagem universal ( @fig-krigagem-comparacao) n√£o revelou diferen√ßas percept√≠veis na superf√≠cie interpolada. Ambas as abordagens produziram mapas semelhantes, com padr√µes espaciais suaves e coerentes com a distribui√ß√£o dos dados observados.\n\nEssa aus√™ncia de distin√ß√£o visual pode ser explicada por caracter√≠sticas da pr√≥pria √°rea de estudo: a RIDE-DF est√° localizada em uma regi√£o de relevo relativamente plano e cont√≠nuo, com uma distribui√ß√£o espacial de temperatura que, ao menos na data considerada, n√£o apresenta gradientes acentuados ou tend√™ncias marcantes ao longo das coordenadas geogr√°ficas. Em contextos assim, a contribui√ß√£o de uma estrutura de tend√™ncia global tende a ser pequena, fazendo com que a krigagem universal e a ordin√°ria produzam resultados semelhantes.\n\n\n\n\n::: {#cell-fig-krigagem-comparacao .cell}\n\n```{.r .cell-code .hidden}\n# Gr√°fico da krigagem ordin√°ria\np_ordinaria <- ggplot() +\n  geom_sf(data = kpred_latlon, aes(color = var1.pred), size = 0.6) +\n  geom_sf(data = ride_latlon, fill = NA, color = \"black\", linewidth = 0.1) +\n  scale_color_viridis_c(name = \"Temperatura (¬∞C)\", option = \"magma\") +\n  theme_minimal(base_size=12) +\n  labs(title = \"Krigagem Ordin√°ria\", subtitle = \"Sem tend√™ncia espacial\")\n\n# Gr√°fico da krigagem universal\np_universal <- ggplot() +\n  geom_sf(data = st_transform(kpred_uni_sf, 4326), aes(color = var1.pred), size = 0.6) +\n  geom_sf(data = ride_latlon, fill = NA, color = \"black\", linewidth = 0.1) +\n  scale_color_viridis_c(name = \"Temperatura (¬∞C)\", option = \"magma\") +\n  theme_minimal(base_size=12) +\n  labs(title = \"Krigagem Universal\", subtitle = \"Com tend√™ncia espacial (x, y)\")\n\n# Patchwork lado a lado\np_ordinaria + p_universal + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Superf√≠cies de temperatura estimadas por krigagem ordin√°ria (√† esquerda) e universal (√† direita) na RIDE-DF. Ambas apresentam padr√µes espaciais semelhantes, refletindo a distribui√ß√£o dos dados observados.](index_files/figure-jats/fig-krigagem-comparacao-1.png){#fig-krigagem-comparacao}\n:::\n:::\n\n\n\n\nAvaliando a superficie de erros vemos que os erros sao menores perto dos posntos amostrados como esperado lalala \n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Adicione a coluna de vari√¢ncia aos objetos sf\nkpred_latlon$method <- \"Ordin√°ria\"\nkpred_latlon$var <- kpred$var1.var\n\nkpred_uni_latlon <- st_transform(kpred_uni_sf, 4326)\nkpred_uni_latlon$method <- \"Universal\"\nkpred_uni_latlon$var <- kpred_uni$var1.var\n\n# Junta ambos para facilitar o plot com facetas ou patchwork\nerros_comb <- rbind(kpred_latlon, kpred_uni_latlon)\n```\n:::\n\n\n\n\nAvaliando a superf√≠cie do erro padr√£o das predi√ß√µes por krigagem (@fig-superficie-erro-padrao), observa-se que os menores valores de incerteza concentram-se nas regi√µes pr√≥ximas aos pontos de amostragem, como era esperado. Nessas √°reas, a densidade de informa√ß√£o observada permite ao modelo realizar predi√ß√µes mais confi√°veis, reduzindo a vari√¢ncia associada. Por outro lado, nas por√ß√µes mais perif√©ricas da RIDE, especialmente em trechos do norte, nordeste e extremo oeste ‚Äî, os valores do erro padr√£o se elevam, refletindo a maior dist√¢ncia em rela√ß√£o aos dados utilizados no ajuste da krigagem.\n\nEsse comportamento √© caracter√≠stico do m√©todo geoestat√≠stico adotado, uma vez que a precis√£o da predi√ß√£o decai com o aumento da dist√¢ncia em rela√ß√£o aos pontos observados. Al√©m disso, nota-se que tanto a krigagem ordin√°ria quanto a universal apresentaram padr√µes similares de erro padr√£o, refor√ßando a conclus√£o de que a inclus√£o da tend√™ncia espacial n√£o resultou em ganhos substantivos de acur√°cia no presente contexto.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Para krigagem ordin√°ria\nkpred_latlon$erro_padrao <- sqrt(kpred$var1.var)\n\n# Para krigagem universal\nkpred_uni_latlon$erro_padrao <- sqrt(kpred_uni$var1.var)\n```\n:::\n\n::: {#cell-fig-superficie-erro-padrao .cell}\n\n```{.r .cell-code .hidden}\n# Erro padr√£o ordin√°rio\ng1 <- ggplot() +\n  geom_sf(data = kpred_latlon, aes(color = erro_padrao), size = 0.6) +\n  geom_sf(data = ride_latlon, fill = NA, color = \"black\", linewidth = 0.1) +\n  scale_color_viridis_c(name = \"Erro padr√£o (¬∞C)\") +\n  theme_minimal(base_size=12) +\n  labs(title = \"Erro padr√£o\\n Krigagem Ordin√°ria\")\n\n# Erro padr√£o universal\ng2 <- ggplot() +\n  geom_sf(data = kpred_uni_latlon, aes(color = erro_padrao), size = 0.6) +\n  geom_sf(data = ride_latlon, fill = NA, color = \"black\", linewidth = 0.1) +\n  scale_color_viridis_c(name = \"Erro padr√£o (¬∞C)\") +\n  theme_minimal(base_size=12) +\n  labs(title = \"Erro padr√£o\\n Krigagem Universal\")\n\n# Patchwork com legenda √∫nica\ng1 + g2 + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Superf√≠cie do erro padr√£o das predi√ß√µes por krigagem ordin√°ria (√† esquerda) e universal (√† direita) na RIDE-DF. Valores mais baixos pr√≥ximos aos pontos amostrados indicam maior confian√ßa na interpola√ß√£o nessas √°reas.](index_files/figure-jats/fig-superficie-erro-padrao-1.png){#fig-superficie-erro-padrao}\n:::\n:::\n\n\n\n## Conclus√µes\n\nA superf√≠cie de temperatura estimada pela krigagem  revela padr√µes espaciais coerentes com as caracter√≠sticas geogr√°ficas e ambientais da Regi√£o Integrada de Desenvolvimento do Distrito Federal e Entorno (RIDE-DF). Observa-se uma tend√™ncia de temperaturas mais elevadas nas por√ß√µes norte e oeste da regi√£o, especialmente em munic√≠pios como Cavalcante, Alto Para√≠so de Goi√°s, Niquel√¢ndia e Barro Alto. Essas localidades s√£o marcadas por altitudes relativamente mais baixas, presen√ßa predominante de √°reas abertas, pastagens e agricultura extensiva, e menor cobertura florestal, fatores que favorecem maior absor√ß√£o de radia√ß√£o solar e aquecimento da superf√≠cie terrestre (Moraga, 2022). E eu tamb√©m por acaso j√° notei que Cavalcante costuma ser bem mais quente que Bras√≠lia quando vou la acambar no Parque Nacional da Chapada dos Veadeiros.\n\nEm contraste, as temperaturas mais amenas concentram-se na por√ß√£o sul da RIDE, em munic√≠pios como Cristalina, Luzi√¢nia, Cidade Ocidental e Novo Gama, al√©m do centro-leste da regi√£o, abrangendo o Distrito Federal. Essa distribui√ß√£o se alinha √† topografia mais elevada do Planalto Central, onde altitudes frequentemente superam os 1.000 metros, contribuindo para uma modera√ß√£o t√©rmica natural. A maior presen√ßa de manchas urbanas cont√≠nuas com arboriza√ß√£o significativa, aliada a √°reas de prote√ß√£o ambiental como o Parque Nacional de Bras√≠lia, tamb√©m pode resultar em temperaturas de superf√≠cie mais baixas, configurando, em alguns trechos, o fen√¥meno conhecido como ‚Äúilha de frescor urbano‚Äù\n\nOs dados utilizados referem-se √† temperatura da superf√≠cie terrestre (Land Surface Temperature ‚Äì LST) captada via sensoriamento remoto no per√≠odo diurno (~10h30), sendo sens√≠veis √† cobertura e ao uso do solo, √† umidade superficial e ao relevo. Como a data de refer√™ncia √© 22 de outubro de 2020, dia do anivers√°rio da autora, e tamb√©m um dos mais quentes daquele ano na regi√£o ‚Äî, a escolha do recorte temporal n√£o foi apenas afetiva, mas tamb√©m clim√°tica. Trata-se de um momento de transi√ß√£o entre a esta√ß√£o seca e o in√≠cio da esta√ß√£o chuvosa no Centro-Oeste, per√≠odo marcado por altos √≠ndices de radia√ß√£o solar e baixa umidade do solo.\n\nCuriosamente, embora a mem√≥ria t√©rmica da autora guarde a Asa Norte como um forno reformando sem ar-condicionado, os dados mostram que havia regi√µes significativamente mais quentes na RIDE naquele dia. Assim, o sofrimento era real, mas n√£o estava sozinho: a superf√≠cie do Planalto queimava de forma coletiva\n\n## Refer√™ncias {.unnumbered}\n\n:::{#refs}\n\n:::",
    "supporting": [
      "index_files/figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}